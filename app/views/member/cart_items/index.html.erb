<div class="container-fluid">

  <div class="row ml-5 mt-5">
    <h2 class="ml-3 badge-light">ショッピングカート</h2>
    <div class="float-right mr-4"> <%= link_to 'カートを空にする', cart_items_all_destroy_path, method: :delete, class: 'btn btn-danger ' %></div>
  </div>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>商品名</th>
        <th>単価（税込）</th>
        <th>数量</th>
        <th>小計</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <% @cart_items.each do |cart_item| %>
        <td><%= cart_item.item_id.name%></td>
        <td><%= cart_item.item.with_tax_price %></td>
          <%= form_with model: @cart_item, local: true do |f| %>
          <td>
            <%= f.select :amount, *[1..10] %>
            <%= f.submit '変更',  cart_item_path, method: :patch, class: 'btn btn-success' %>
          </td>
          <% end %>
        <td><%= cart_item.subtotal %></td>
        <td><%= link_to '削除する', cart_item_path, method: :delete, class: 'btn btn-danger ' %></td>
        <% end %>
      </tr>
    </tbody>
  </table>
  <div>
    <%= link_to '買い物を続ける', cart_items_path, method: :get, class: 'btn btn-primary ' %>
  </div>
  <table class="table table-bordered">
    <tr>
      <th>合計金額</th>
      <th><% @合計金額 +=  @cart_items.subtotal %></th>
    </tr>
  </table>
  <div class ="mx-4 my-auto text-center"><%= link_to '情報入力に進む', cart_items_path, method: :get, class: 'btn btn-success'  %></div>
</div>
